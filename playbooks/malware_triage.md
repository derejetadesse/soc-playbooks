# Incident Response Playbook — Malware Triage

**Goal:** Rapidly assess suspect file/process, contain impact, and choose eradication path.

## 1) Initial Intake
- Source: user report, EDR alert, mail gateway, SOC queue.
- Gather host, user, timestamp, process tree, and network indicators.

## 2) Containment
- EDR isolate host or disconnect network if EDR absent.
- Kill malicious process tree; disable autoruns created by the sample.

## 3) Evidence Collection
- Hashes (MD5/SHA256) for sample and dropped files.
- File path, signer, first-seen; persistence (Run keys, Services, Scheduled Tasks).
- Network IOCs: domains, IPs, ports, JA3/JA3S if TLS present.
- Export EDR/Sysmon events ±2h around first-seen.

## 4) Enrichment & Analysis
- Hash lookups (per policy): VirusTotal/Hybrid-Analysis/ThreatFox.
- Static: strings, PE metadata, imports. Dynamic: sandbox detonation in isolated env.
- Map behaviors to **MITRE ATT&CK** techniques.

## 5) Eradication & Recovery
- Remove malware and persistence; patch exploited vulnerability.
- Reimage if integrity uncertain; rotate creds used on host.
- Unblock network once clean; monitor 24–48h in SIEM/EDR.

## 6) Related Detections
- **Sigma:** suspicious PowerShell, after-hours admin logons.
- **Suricata:** scripted user-agents / rare C2 patterns.
- **Zeek:** long DNS queries, beaconing anomalies.

## 7) Documentation
- Timeline, decisions, IOCs, lessons learned.
- Ticket/case ID for traceability.
